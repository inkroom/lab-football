<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<c:set var="path" value="${pageContext.request.contextPath}"/>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>球员个人中心</title>
    <link rel="stylesheet" type="text/css" href="${path}/resources/lib/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="${path}/resources/css/player/playerupdate.css" />
    <link rel="stylesheet" type="text/css" href="${path}/resources/css/player/coach_info.css" />
    <script src="${path}/resources/lib/respond.min.js"></script>
    <style>
        .file_ img{
            width: 120px;height: 140px;
        }
        .file_{
            position: relative;
        }
        .file_ input{
            border: 1px solid red;
            width: 120px;height: 140px;
            position: absolute;left:50%;
            margin-left:-60px;
            opacity: 0;
            cursor: pointer;
        }
    </style>
</head>
<body>
<nav class="nav-bg navbar">
    <div class="container">
        <div class="logo-w col-lg-4 col-md-5 col-sm-11 col-xs-12">
            <img src="${path}/resources/img/player/logoImage.png" />
            <span>四川省青少年校园足球信息网</span>
        </div>
        <div class="nav-b hidden-lg hidden-md col-sm-1 hidden-xs">
            <button type="button" class="btn">菜单</button>
        </div>
        <div class="nav-w col-lg-8 col-md-7 hidden-sm hidden-xs">
            <ul>
                <li>
                    <a href="#">赛事赛程</a>
                </li>
                <li>
                    <a href="#">教练管理</a>
                </li>
                <li>
                    <a href="#">球员管理</a>
                </li>
                <li>
                    <a href="#">球队管理</a>
                </li>
                <li>
                    <a href="#">个人中心</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="coach-table" id="div1">
    <table class="table table-bordered text-center table-striped class" style="word-break:break-all; word-wrap:break-all;">
        <caption></caption>
        <thead>
        <tr>
            <th colspan="7">
                <%--<a href="#"><button type="button" class="btn btn-default">返回</button></a>--%>
                <button type="button" class="btn btn-success pull-right" style="display: none;" onclick="ch()">保存</button>
                <!--                        <button type="button" class="btn btn-primary pull-right" style="display: ;" >编辑</button>-->
                <button onclick="toEdit();return false;" class="btn btn-primary pull-right">编辑</button>
            </th>

        </tr>
        </thead>
        <tbody>
        <tr>
            <fmt:bundle basename="properties.upload">
            <td rowspan="3" class="file_">
                <input type="file" onchange="handleFiles(this.files,this.parentNode)">
                <c:if test="${!empty (item.headPic)}">
                    <img src="${path}/<fmt:message key="upload.image.url.prefix"/>/${item.headPic}">
                </c:if>
                <c:if test="${empty item.headPic}">
                   <img src="${path}/resources/img/player/upimg.png">
                </c:if>
            </td>
            </fmt:bundle>
            <td>用户名</td>
            <td class="div2">${item.userName }</td>
            <td>姓名</td>
            <td class="div2">${item.name }</td>
            <td>身份证号码</td>
            <td class="div2">${item.idCard }</td>
        </tr>
        <tr>
            <td>性别</td>
            <td class="div2">${item.sex }</td>
            <td>年级</td>
            <td class="div2">${item.grade }级</td>
            <td>班级</td>
            <td class="div2">${item.classes }班</td>
        </tr>
        <tr>
            <td>分数</td>
            <td class="div2">${item.score }</td>
            <td>球队</td>
            <c:forEach var="teamname" items="${teamName}">${teamname} </c:forEach>
            <td class="div2">${teamname }</td>
            <td>学校信息</td>
            <td class="div2">${orgname }</td>
        </tr>
        </tbody>
    </table>
    <input type="hidden" id="token" value="${token}">
</div>

<script>
    function toEdit() {
        window.location.href="${path}/player/edit";
    }
    function handleFiles(file, obj) {
        //获取当前点击的元素的所有同级元素的html内容
        var con = obj.innerHTML;
        //判断当前点击元素内是否已经存在img图片元素，如果有则先全部清除后再添加，如果没有就直接添加
        if (con.indexOf("img") > 0) {
            var pic = obj.getElementsByTagName("img");
            for (var i = 0; i < pic.length; i++) {
                obj.removeChild(pic[i]);
            }
            //调用添加img图片的函数
            creatImg();
        } else {
            creatImg();
        }

        function creatImg() {
            //创建一个img元素
            var img = document.createElement("img");
            //设置img元素的源文件路径，window.URL.createObjectURL() 方法会根据传入的参数创建一个指向该参数对象的URL. 这个URL的生命仅存在于它被创建的这个文档里
            img.src = window.URL.createObjectURL(file[0]);
            //window.URL.revokeObjectURL() 释放一个通过URL.createObjectURL()创建的对象URL，在图片被显示出来后，我们就不再需要再次使用这个URL了，因此必须要在加载后释放它
            img.onload = function() {
                window.URL.revokeObjectURL(this.src);
            }
            //在当前点击的input元素后添加刚刚创建的img图片元素
            obj.appendChild(img);
        }
    }
</script>
</body>
</html>
