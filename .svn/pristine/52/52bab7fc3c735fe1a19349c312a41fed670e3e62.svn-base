<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<c:set var="path" value="${pageContext.request.contextPath}"/>
<html>
<head>
    <title>修改球员信息</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="${path}/resources/css/player/updatelist.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="${path}/resources/lib/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="${path}/resources/css/player/playerupdate.css" />
    <link rel="stylesheet" type="text/css" href="${path}/resources/css/player/innerupdate.css" />
</head>
<body>
<nav class="nav-bg navbar">
    <div class="container">
        <div class="logo-w col-lg-4 col-md-5 col-sm-11 col-xs-12">
            <img src="${path}/resources/img/player/logoImage.png" />
            <span>四川省青少年校园足球信息网</span>
        </div>
        <div class="nav-b hidden-lg hidden-md col-sm-1 hidden-xs">
            <button type="button" class="btn">菜单</button>
        </div>
        <div class="nav-w col-lg-8 col-md-7 hidden-sm hidden-xs">
            <ul>
                <li>
                    <a href="#">赛事赛程</a>
                </li>
                <li>
                    <a href="#">教练管理</a>
                </li>
                <li>
                    <a href="#">球员管理</a>
                </li>
                <li>
                    <a href="#">球队管理</a>
                </li>
                <li>
                    <a href="#">个人中心</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="wrapper">
    <form class="form-horizontal" id="update1" method="post">
        <h2>球员信息修改</h2>
        <div class="control-group">
            <label class="control-label" for="inputEmail">姓名</label>
            <div class="controls">
                <input type="text" id="inputEmail" placeholder="姓名" value="${item.name}" name="name">
                <span class="warn" id="warn1">请输入姓名</span>
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <label for="nan" class="sex">男</label>
                <input type="radio" name="sex" id="nan" class="sex_" value="男">
                <label for="nv" class="sex">女</label>
                <input type="radio" name="sex" id="nv" class="sex_" value="女">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="inputPassword">身份证号</label>
            <div class="controls">
                <input type="text" id="inputPassword" placeholder="身份证号" value="${item.idCard}" name="idCard" maxlength="18">
                <span class="warn" id="warn2">请输入正确的身份证号</span>

            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="inputPassword_">原密码</label>
            <div class="controls">
                <input type="password" id="inputPassword_" placeholder="原密码" name="oldPassword">
                <span class="warn" id="warn5">新密码长度至少为6位</span>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="newPassword">新密码</label>
            <div class="controls">
                <input type="password" id="newPassword" placeholder="新密码" name="password">
                <span class="warn" id="warn3">新密码长度至少为6位</span>

            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="inputPassword">地区</label>
            <div class="controls" style="width: 100%">
                <select class="select2" id="city" name="countryCode">
                    <option value="1">选择市</option>
                </select>
                <select class="select2" id="area" name="villageCode">
                    <option value="10002">选择县</option>
                </select>
            </div>
        </div>
                <div class="control-group">
                    <label class="control-label" for="inputPassword" >学校信息</label>
                    <div class="controls" style="width: 100%">
                    <select class="select1" id="school"  name="schoolCode" onclick="getOrg();return false;">
                        <option value="">选择学校</option>
                    </select>
                    </div>
                </div>
        <div class="control-group">
            <label class="control-label" for="inputPassword">班级信息</label>
            <div class="controls">
                <select id="grade" name="grade">
                    <option value="1">1年级</option>
                    <option value="2">2年级</option>
                    <option value="3">3年级</option>
                    <option value="4">4年级</option>
                    <option value="5">5年级</option>
                    <option value="6">6年级</option>
                    <option value="7">7年级</option>
                    <option value="8">8年级</option>
                    <option value="9">9年级</option>
                </select>
                <input type="text" id="grade_" placeholder="班" value="${item.classes}" name="classes">
                <span class="warn" id="warn4" >请输入正确的班级</span>
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <button  class="btn" onclick="checkForm();return false;">确定</button>
                <button class="btn" style="margin-left:40px;"  onclick="goBack();return false;">返回</button>
            </div>
        </div>
    </form>
    <input type="hidden" id="token" value="${token}">
</div>
<script src="${path}/resources/lib/jquery/jquery-3.1.1.min.js"></script>
<script src="${path}/resources/lib/bootstrap/bootstrap.min.js"></script>
<script src="${path}/resources/lib/jquery/jquery-1.11.3.js"></script>
<script src="${path}/resources/lib/bootstrap/bootstrap.min.js"></script>
<script src="${path}/resources/js/player/District.js"></script>
<script src="${path}/resources/lib/layer/layer.js"></script>
<script src="${path}/resources/js/index.js"></script>
</body>
<script>
    var inputPassword_ = document.getElementById("inputPassword");
    var inputEmail_ = document.getElementById("inputEmail");
    var newPassword_ = document.getElementById("newPassword");
    var warn1 = document.getElementById("warn1");
    var warn2 = document.getElementById("warn2");
    var warn3 = document.getElementById("warn3");
    var warn4 = document.getElementById("warn4");
    var oCity = document.getElementById("city_");
    var oSchool = document.getElementById("school");
    var sheng = document.createElement("select");
    var shi = document.createElement("select");
    var qu = document.createElement("select");
    var grade_ = document.getElementById("grade_");
    var inputPasswordA = document.getElementById("inputPassword_");

    var userName = false,
        idCode = false,
        oldPassword = false,
        newPassword = false,
        oClass = false,
        userSchool = false;

    inputEmail_.onblur = function() {
        if (this.value.length < 2) {
            warn1.style.opacity = "1";
            userName = false;
        } else {
            warn1.style.opacity = "0";
            userName = true;
        }
    },
    inputPassword_.onblur = function() {
        if (this.value.length != 18) {
            warn2.style.opacity = "1";
            idCode = false;
        } else {
            warn2.style.opacity = "0";
            idCode = true;
        }
    },
    inputPasswordA.onblur = function() {
        if (this.value.length <6) {
            warn5.style.opacity = "1";
            oldPassword = false;
        } else {
            warn5.style.opacity = "0";
            oldPassword = true;
        }
    },
    newPassword_.onblur = function() {
        if (this.value.length < 6) {
            warn3.style.opacity = "1";
            newPassword = false;
        } else {
            warn3.style.opacity = "0";
            newPassword = true;
        }
    },
    grade_.onblur = function() {
        var value = this.value;
        var reg = /^[1-9]\d*$|^0$/;
        if (reg.test(value) == true) {
            warn4.style.opacity = "0";
            oClass = true;
        } else {
            warn4.style.opacity = "1";
            oClass = false;
        }
    },
    oSchool.onblur = function(){
        if(this.value != ""){
            userSchool = true;
        }else{
            userSchool = false;
        }


    },
    function getOrg(){
        var countryCode = $("#city option:selected").val();
        var villageCode = $("#area option:selected").val();
            ajax({
                type: "POST",   //提交的方法
                url:"/organization/showorg", //提交的地址
                data:{
                    "countrycode":countryCode,
                    "villagecode":villageCode
                },
                dataType:'json',
                success: function(data) {  //成功
                    $.each( data.data.OrgList,function(index,item){
                        $("#school").append("<option value='"+item.schoolCode+"'>"+item.name+"</option>");
                    });
                },
                error: function(data) {  //失败的话
                    console.log(data);
                }
            });
        }
        function doSubmit() {
            $.post(
                "${path}/player/update",
                $("#update1").serialize(),
                function(data){
                    alert(data.status);
                    if(data.status == 0){
                        layer.alert("球员信息更新成功");
                        window.location.href="${path}/player/list";
                    }
                });
        }
        function checkForm(){
//            if (userName && idCode && oldPassword && newPassword && oClass){
                doSubmit();
//            }
        }
        function goBack() {
            window.location.href="${path}/player/list";
        }

</script>

</html>
