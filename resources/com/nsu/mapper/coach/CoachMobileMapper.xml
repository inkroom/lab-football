<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nsu.dao.coach.CoachMobileDao">

	<!-- 通过id查询省级比赛 -->
	<select id="getCoachProvinceMatch" resultType="java.util.HashMap">
		SELECT COMPETITION_NOTICE.COM_NAME,
		RACE_DETAILS.R_REGION,
		RACE_DETAILS.R_H_TEAM_ID,
		RACE_DETAILS.R_V_TEAM_ID,
		RACE_DETAILS.R_WIN_STATUS,
		TEAM.TEAM_ID,
		RACE_DETAILS.COM_ID
		FROM COMPETITION_NOTICE INNER JOIN RACE_DETAILS ON
		COMPETITION_NOTICE.COM_ID=RACE_DETAILS.COM_ID
		INNER JOIN MID_TEAM_RACE ON RACE_DETAILS.R_ID=MID_TEAM_RACE.R_ID
		INNER JOIN TEAM ON TEAM.TEAM_ID=MID_TEAM_RACE.TEAM_ID
		INNER JOIN MID_COACH_TEAM ON MID_COACH_TEAM.TEAM_ID=TEAM.TEAM_ID
		INNER JOIN COACH ON MID_COACH_TEAM.COACH_ID = COACH.COACH_ID
		where COACH.A_ID=#{A_ID,jdbcType=VARCHAR} AND
		COMPETITION_NOTICE.COM_LEVEL=1
	</select>

	<!-- 通过id查询校级比赛 -->
	<select id="getCoachSchoolMatch" resultType="java.util.HashMap">
		SELECT COMPETITION_NOTICE.COM_NAME,
		RACE_DETAILS.R_REGION,
		RACE_DETAILS.R_H_TEAM_ID,
		RACE_DETAILS.R_V_TEAM_ID,
		RACE_DETAILS.R_WIN_STATUS,
		TEAM.TEAM_ID,
		RACE_DETAILS.COM_ID
		FROM COMPETITION_NOTICE INNER JOIN RACE_DETAILS ON
		COMPETITION_NOTICE.COM_ID=RACE_DETAILS.COM_ID
		INNER JOIN MID_TEAM_RACE ON RACE_DETAILS.R_ID=MID_TEAM_RACE.R_ID
		INNER JOIN TEAM ON TEAM.TEAM_ID=MID_TEAM_RACE.TEAM_ID
		INNER JOIN MID_COACH_TEAM ON MID_COACH_TEAM.TEAM_ID=TEAM.TEAM_ID
		INNER JOIN COACH ON MID_COACH_TEAM.COACH_ID = COACH.COACH_ID
		where COACH.A_ID=#{A_ID,jdbcType=VARCHAR} AND
		COMPETITION_NOTICE.COM_LEVEL=4
	</select>

	<!-- 通过id查询县级比赛 -->
	<select id="getCoachCountyMatch" resultType="java.util.HashMap">
		SELECT COMPETITION_NOTICE.COM_NAME,
		RACE_DETAILS.R_REGION,
		RACE_DETAILS.R_H_TEAM_ID,
		RACE_DETAILS.R_V_TEAM_ID,
		RACE_DETAILS.R_WIN_STATUS,
		TEAM.TEAM_ID,
		RACE_DETAILS.COM_ID
		FROM COMPETITION_NOTICE INNER JOIN RACE_DETAILS ON
		COMPETITION_NOTICE.COM_ID=RACE_DETAILS.COM_ID
		INNER JOIN MID_TEAM_RACE ON RACE_DETAILS.R_ID=MID_TEAM_RACE.R_ID
		INNER JOIN TEAM ON TEAM.TEAM_ID=MID_TEAM_RACE.TEAM_ID
		INNER JOIN MID_COACH_TEAM ON MID_COACH_TEAM.TEAM_ID=TEAM.TEAM_ID
		INNER JOIN COACH ON MID_COACH_TEAM.COACH_ID = COACH.COACH_ID
		where COACH.A_ID=#{A_ID,jdbcType=VARCHAR} AND
		COMPETITION_NOTICE.COM_LEVEL=3
	</select>
	
	<!-- 通过id查询不限级别的比赛 -->
	<select id="getCoachOtherMatch" resultType="java.util.HashMap">
		SELECT COMPETITION_NOTICE.COM_NAME,
		RACE_DETAILS.R_REGION,
		RACE_DETAILS.R_H_TEAM_ID,
		RACE_DETAILS.R_V_TEAM_ID,
		RACE_DETAILS.R_WIN_STATUS,
		TEAM.TEAM_ID,
		RACE_DETAILS.COM_ID
		FROM COMPETITION_NOTICE INNER JOIN RACE_DETAILS ON
		COMPETITION_NOTICE.COM_ID=RACE_DETAILS.COM_ID
		INNER JOIN MID_TEAM_RACE ON RACE_DETAILS.R_ID=MID_TEAM_RACE.R_ID
		INNER JOIN TEAM ON TEAM.TEAM_ID=MID_TEAM_RACE.TEAM_ID
		INNER JOIN MID_COACH_TEAM ON MID_COACH_TEAM.TEAM_ID=TEAM.TEAM_ID
		INNER JOIN COACH ON MID_COACH_TEAM.COACH_ID = COACH.COACH_ID
		where COACH.A_ID=#{A_ID,jdbcType=VARCHAR} AND
		COMPETITION_NOTICE.COM_LEVEL=5
	</select>

	<!-- 通过id查询市级比赛 -->
	<select id="getCoachCityMatch" resultType="java.util.HashMap">
		SELECT COMPETITION_NOTICE.COM_NAME,
		RACE_DETAILS.R_REGION,
		RACE_DETAILS.R_H_TEAM_ID,
		RACE_DETAILS.R_V_TEAM_ID,
		RACE_DETAILS.R_WIN_STATUS,
		TEAM.TEAM_ID,
		RACE_DETAILS.COM_ID
		FROM COMPETITION_NOTICE INNER JOIN RACE_DETAILS ON
		COMPETITION_NOTICE.COM_ID=RACE_DETAILS.COM_ID
		INNER JOIN MID_TEAM_RACE ON RACE_DETAILS.R_ID=MID_TEAM_RACE.R_ID
		INNER JOIN TEAM ON TEAM.TEAM_ID=MID_TEAM_RACE.TEAM_ID
		INNER JOIN MID_COACH_TEAM ON MID_COACH_TEAM.TEAM_ID=TEAM.TEAM_ID
		INNER JOIN COACH ON MID_COACH_TEAM.COACH_ID = COACH.COACH_ID
		where COACH.A_ID=#{A_ID,jdbcType=VARCHAR} AND
		COMPETITION_NOTICE.COM_LEVEL=2
	</select>
	
	<!-- 通过id查询COM_ID -->
	<select id="getCoachCOM_ID" resultType="java.util.HashMap">
		SELECT DISTINCT COMPETITION_NOTICE.COM_NAME,
		RACE_DETAILS.COM_ID,
		COMPETITION_NOTICE.COM_WINNER,
		COMPETITION_NOTICE.COM_SECOND,
		COMPETITION_NOTICE.COM_THIRD
		FROM COMPETITION_NOTICE INNER JOIN RACE_DETAILS ON
		COMPETITION_NOTICE.COM_ID=RACE_DETAILS.COM_ID
		INNER JOIN MID_TEAM_RACE ON RACE_DETAILS.R_ID=MID_TEAM_RACE.R_ID
		INNER JOIN TEAM ON TEAM.TEAM_ID=MID_TEAM_RACE.TEAM_ID
		INNER JOIN MID_COACH_TEAM ON MID_COACH_TEAM.TEAM_ID=TEAM.TEAM_ID
		INNER JOIN COACH ON MID_COACH_TEAM.COACH_ID = COACH.COACH_ID
		where COACH.A_ID=#{A_ID,jdbcType=VARCHAR} AND
		COMPETITION_NOTICE.COM_LEVEL=#{COM_LEVEL,jdbcType=VARCHAR}
	</select>
	<select id="getCoachID" resultType="java.util.HashMap">
	SELECT COACH.COACH_ID,(SELECT ACCOUNT.A_NAME FROM ACCOUNT JOIN COACH ON ACCOUNT.A_ID=COACH.A_ID WHERE COACH.A_ID=#{A_ID,jdbcType=VARCHAR}) AS COACH_NAME FROM COACH where COACH.A_ID=#{A_ID,jdbcType=VARCHAR}
	</select>
	<select id="getTeamPushInfo" resultType="String">
	SELECT ACCOUNT.A_PUSH_INFO from ACCOUNT 
join PLAYER  on PLAYER.A_ID=ACCOUNT.A_ID
join MID_PLAYER_TEAM on MID_PLAYER_TEAM.P_ID=PLAYER.P_ID
WHERE MID_PLAYER_TEAM.TEAM_ID=#{team_id,jdbcType=VARCHAR} AND PLAYER.P_STATUS=1
	
	</select>
	
	
</mapper> 