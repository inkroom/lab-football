<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.nsu.edu.web.four.daos.jdbc.referee.RefereeDao">

  <resultMap id="BaseResultMap" type="cn.nsu.edu.web.four.beans.schedule.Schedule">
    <id column="id_schedule" property="idSchedule" jdbcType="INTEGER"/>
    <result column="team_A" property="teamA" jdbcType="INTEGER"/>
    <result column="team_B" property="teamB" jdbcType="INTEGER"/>
    <result column="begin_time"  property="beginTime" jdbcType="DATE"/>
    <result column="place" property="place" jdbcType="VARCHAR"/>
    <association property="referee" javaType="cn.nsu.edu.web.four.beans.referee.Referee">
      <id column="id_referee" property="idReferee" jdbcType="INTEGER"/>
      <result column="id_sch" property="idSch" jdbcType="INTEGER"/>
    </association>
  </resultMap>

  <resultMap id="Player" type="cn.nsu.edu.web.four.beans.player.Player">
    <id column="id_player" property="id_player" jdbcType="INTEGER"/>
    <result column="name" property="name" jdbcType="VARCHAR"/>
    <result column="headpic" property="headpic" jdbcType="VARCHAR"/>
    <association property="matchStaff" javaType="cn.nsu.edu.web.four.beans.matchStaff.MatchStaff">
      <id column="id" property="id" jdbcType="INTEGER"/>
      <result column="playerId" property="player_id" jdbcType="INTEGER"/>
    </association>
  </resultMap>

  <select id="getScheduleInformation" parameterType="Integer" resultMap="BaseResultMap">
    select begin_time,team_A,team_B,place from Schedule s
	join Referee r on r.id_sch=s.id_schedule
	where id_sch=#{scheduleId}
  </select>

  <select id="getPlayerInformation" parameterType="Integer" resultMap="Player">
    select name,headpic from Player p
    join M_Match_Staff m on p.id_player=m.player_id
    where team_id=#{teamId}
  </select>

  <insert id="insertPlayerInformation" parameterType="java.util.Map">
    insert into M_Sch_Staff(player_id,sch_id,team_id,time) VALUES(#{playerId},#{scheduleId},#{teamId},#{time})
  </insert>
</mapper>